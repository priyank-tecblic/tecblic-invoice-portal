<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- JavaScript Bundle with Popper -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.2.0/css/datepicker.min.css"
        rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.2.0/js/bootstrap-datepicker.min.js"></script>
    <link rel="icon" type="image/x-icon" href="/static/tecblic.png">
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">

    <link href="/static/assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
    <link href="/static/assets/css/material-dashboard-rtl.css?v=2.1.2" rel="stylesheet" />

<style>
  body{
    background-color: white;
    overflow-x: hidden;
  }
        * {
          box-sizing: border-box;
        }
        input[type=text], select, textarea {
          width: 100%;
          padding: 12px;
          border: 1px solid #ccc;
          border-radius: 4px;
          resize: vertical;
        }
        
        label {
          padding: 12px 12px 12px 0;
          display: inline-block;
        }
        
        input[type=submit] {
          background-color: #04AA6D;
          color: white;
          padding: 12px 20px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          float: right;
        }
        
        input[type=submit]:hover {
          background-color: #45a049;
        }
        
        .container {
          border-radius: 5px;
          background-color: #f2f2f2;
          padding: 20px;
        }
        
        .col-25 {
          float: left;
          width: 25%;
          margin-top: 6px;
        }
        
        .col-75 {
          float: left;
          width: 75%;
          margin-top: 6px;
        }
        
        /* Clear floats after the columns */
        .row:after {
          content: "";
          display: table;
          clear: both;
        }
        
        /* Responsive layout - when the screen is less than 600px wide, make the two columns stack on top of each other instead of next to each other */
        @media screen and (max-width: 600px) {
          .col-25, .col-75, input[type=submit] {
            width: 100%;
            margin-top: 0;
          }
        }
       
        .form-control, .is-focused .form-control {
    background-image: linear-gradient(to top, #000000 2px, rgba(156, 39, 176, 0) 2px), linear-gradient(to top, #d2d2d2 1px, rgba(210, 210, 210, 0) 1px);
}
#addform
{
  visibility: hidden;
}
input[type=text]
{
    width: 140%;
    
}
input[type=email]
{
    width: 190%;
}
</style>
   
    
    <title>Document</title>
</head>
<body>
{% include 'tecblicapp/navbar.html' %}
{% block content %}

{% endblock %}
<form method="GET" id="searchform" class="flex-container" action="/banksearch" style="z-index:2;position:absolute;right:2%;top: 144px" >
  <input class="mt-1 form-control mr-sm-2" style="width:300px;background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);font-weight: bold;" type="search" style="position: relative;; left: 100px;" name="query" id="query" placeholder="Search" aria-label="Search">
  <i style="position: relative;top: -28px;right: -284px;z-index: 1;" type="button" onclick="document.getElementById('searchform').submit();" class="fa fa-search" aria-hidden="true"></i>
</form>


      <!-- <div class="row" style="font-family: Georgia, 'Times New Roman', Times, serif; ">
        <div class="col-sm-4">
          <h4 class="text-center alert alert-info" style="background-color: #e6f7ff;">Add/Update Bank Details</h4>
          <form id="form" action="bank_form"  method="POST">
            {% csrf_token %}
            <input type="hidden" name="bank_id" id="bank_id">
            {{form.as_p}}
            <input type="submit" class="btn btn-success" id="bankbtnsave" value="Save">
          </form>
        </div> -->
        <button id="details" disabled class="btn bg-light text-dark btn-sm"  style="z-index: 3;position: relative;bottom: -20px;left: 0.9%;">Details</button>
        <button  id="addclient"  class="btn bg-dark btn-sm" style="z-index: 3;position: relative;bottom: -20px;left: 1%;">Add</button>
        <div class="col" style="font-family: Georgia, 'Times New Roman', Times, serif;">
          {% csrf_token %}
          <h4 class="text-center text-dark table-detail" style="font-size: 35px;font-weight: 800">Bank Details</h4>
          
          <!-- <i class="fa fa-plus" data-bs-toggle="modal" data-bs-target="#exampleModal" style="font-size: 50px;position: relative;bottom: 55px;size:30px;left: 93%;cursor: pointer;user-select: none;" type='button' aria-hidden="true"></i> -->
          
          <!-- Modal -->
          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content" style="border-radius: 20px;"">
                <div class="modal-header">
                  <h5 class="modal-title font-weight-bold" style="margin-left:33%;font-size: 35px;" id="exampleModalLabel">Add Bank</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
  
                    </div>
                </div>
            </div>
          </div>
  <div id="table" style="position: absolute;top: 160%;left:5%;width: 90%;">
    <div id="addform" style="position: absolute;width: 100%;top: -24%;" >
      <h5 class="modal-title font-weight-bold text-dark text-center" style="font-size: 35px;position:relative;bottom: 50px;right: 20px;" id="exampleModalLabel">Add Bank</h5>

    <form action="bank_form" id="form_submit" method="post">
      {% csrf_token %}
      <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">Bank Name</label>
        <div class="col-auto"  style="position: relative;right: 5%;">
            <label><input type="text"  value="{{i.bank_name}}"  required  class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "bank_name" placeholder="Bank Name" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">Account no</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.account_no}}"  required class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "account_no"  placeholder="Account Number" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">IFSC Code</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.ifsc_code}}" required class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "ifsc_code"  placeholder="IFSC" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">Bank Branch</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.bank_branch}}" required class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "bank_branch" placeholder="Branch" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">SWIFT Code</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.swift_code}}" class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "swift_code"  placeholder="SWIFT" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">CIN</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.cin}}" required class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "cin"  placeholder="CIN" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">Supplier PAN</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.supplier_pan}}" id="pan" required class="form-control" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "supplier_pan" placeholder="PAN" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">Supplier GSTIN</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.supplier_gstin}}" id="gst" required class="form-control" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "supplier_gstin"  placeholder="GST" required></label>
        </div>
    </div>
    <div class="form-group row" style="position: relative;left: 30%;">
        <label class="col-sm-2 col-form-label text-dark" style="font-weight: bold;margin-top:11px;margin-right:20px;">ARN</label>
        <div class="col-auto" style="position: relative;right: 5%;">
            <label><input type="text" value="{{i.arn}}" required class="form-control",id="desription{{forloop.counter}}" style="background-image: linear-gradient(to top, rgb(39, 37, 37) 2px, rgba(255, 255, 255, 0) 2px), linear-gradient(to top, #1d1b1b 1px, rgba(255, 255, 255, 0) 1px);color:rgb(39, 37, 37);" name = "arn"  placeholder="ARN" required></label>
        </div>
    </div>

<div  style="width:7%;position: relative;left: 44%;">
  <button type="submit" class="btn bg-dark" style="">Save</button>
</div>

</form>
</div>
          <table class="table table-striped table-hover table-bordered  table-detail">
            <thead>
              <tr class="text-center"
              id="heading">
                <th scope="col" style="font-weight:800;font-size: large;">Bank Name</th>
                <th scope="col" style="font-weight:800;font-size: large;">Account No</th>
                <th scope="col" style="font-weight:800;font-size: large;">IFSC Code</th>
                <th scope="col" style="font-weight:800;font-size: large;">Bank Branch</th>
                <th scope="col" style="font-weight:800;font-size: large;">Swift Code</th>
                <th scope="col" style="font-weight:800;font-size: large;">Cin</th>
                <th scope="col" style="font-weight:800;font-size: large;">Supplier Pan</th>
                <th scope="col" style="font-weight:800;font-size: large;">Supplier GSTIN</th>
                <th scope="col" style="font-weight:800;font-size: large;">ARN</th>
                <th scope="col" style="font-weight:800;font-size: large;">Edit</th>
                
              </tr>
            </thead>
            <tbody id="tbody" class="text-center">
                    {% for bank in bankdetails %}
                    <tr>
                      <td id="name{{bank.id}}">{{ bank.bank_name }}</td>
                      <td id="account_no{{bank.id}}">{{bank.account_no  }}</td>
                      <td id="ifsc{{bank.id}}">{{ bank.ifsc_code  }}</td>
                      <td id="bank_branch{{bank.id}}">{{bank.bank_branch }}</td>
                      <td id="swift_code{{bank.id}}">{{bank.swift_code }}</td>
                      <td id="cin{{bank.id}}">{{bank.cin }}</td>
                      <td id="pan{{bank.id}}">{{bank.supplier_pan }}</td>
                      <td id="gstin{{bank.id}}">{{bank.supplier_gstin }}</td>
                      <td id="arn{{bank.id}}">{{bank.arn }}</td>
                      <td><a  href="edit_b?pk={{bank.id}}" style="border-radius: 20px;color: black;" class=" "><i class="fa fa-edit"></i></i></a></td>
                      <!-- <td><input type="button" data-sid="{{bank.id}}" class="btn btn-danger btn-del" value="Delete"></td> -->
                      
                    </tr>
                    
                    
                    {% endfor %}
                  </tbody>
                  
                </table>
                

              
              
              <nav aria-label="Page navigation example " class="mt-4 table-detail" style="margin: auto;width: 25%;">
                <ul class="pagination" style="justify-content: center;">
                  {% if bankdetails.has_previous %}
                  <li class="page-item"><a class="page-link text-dark" href="/bank?page={{bankdetails.previous_page_number}}"><i class="fa fa-chevron-left"  style="font-weight: bold;" aria-hidden="true"></i></a></li>
                  {% endif %}
                  {% for i in totalpages %}
                  <li class="page-item 
                  {% if bankdetails.number == i %}
                  bg-dark
                  {% else %}
                  {% endif %}" style=""><a class="page-link " style="color:{% if bankdetails.number == i %}white;{% else %}black;{% endif %}" href="/bank?page={{i}}">{{i}}</a></li>
                    {% endfor %}
                    {% if bankdetails.has_next %}
                    <li class="page-item"><a class="page-link text-dark" href="/bank?page={{bankdetails.next_page_number}}"><i class="fa fa-chevron-right"  style="font-weight: bold;" aria-hidden="true"></i></a></li>
                    {% endif %}
                  </ul>
                </nav>
                </div>
              </div>
           
            <!-- <script>
    //           $("tbody").on("click",".btn-del",function(){
    //             console.log('delete butto clicked');
    //     let id=$(this).attr("data-sid");
    //     var csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
        
    //     mydata={cid:id,'csrfmiddlewaretoken':csrf_token}
    //     mythis=this;
    //     $.ajax({
    //       url:"{% url 'delete_banks' %}",
    //       method:"POST",
    //       data:mydata,
    //       success:function(data){
    //         if(data.status==1){
    //           $(mythis).closest("tr").fadeOut();
    //           alert('You data is deleted successfully')
    //         }
    //       }
    //     })
    //   })
      
    //   $("tbody").on("click",".btn-edit",function(){
    //     console.log('edit butto clicked');
    //     let id=$(this).attr("data-sid");
    //     var csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
        
    //     mydata={cid:id,'csrfmiddlewaretoken':csrf_token}
        
    //     $.ajax({
    //       url:"{% url 'edit_bank' %}",
    //       method:"POST",
    //         data:mydata,
    //         dataType:"json",
    //         success:function(data){
    //           console.log(data.id)
    //           $("#bank_id").val(data.id);
    //           $("#banknameid").val(data.bank_name);
    //           $("#ifscid").val(data.ifsc);
              
    //           $("#branchid").val(data.bank_branch);
    //           $("#accountid").val(data.account_no);
    //           $("#supplier_panid").val(data.supplier_pan);
    //             $("#supplier_gstinid").val(data.supplier_gstin);
    //             $("#swiftcode_id").val(data.swift_code);
    //             $("#cin_id").val(data.cin);
    //             $("#arn_id").val(data.arn);
                
                
    //         }
    //     })
    // })

    $("tbody").on("click",".btn-edit",function(){
        console.log('edit butto clicked');
        let id=$(this).attr("data-sid");
        
        console.log(id)
        $('#name'+id).html('<input type="text" value="'+$('#name'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#account_no'+id).html('<input type="text" value="'+$('#account_no'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#ifsc'+id).html('<input type="text" value="'+$('#ifsc'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#bank_branch'+id).html('<input type="text" value="'+$('#bank_branch'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#swift_code'+id).html('<input type="text" value="'+$('#swift_code'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#cin'+id).html('<input type="text" value="'+$('#cin'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#pan'+id).html('<input type="text" value="'+$('#pan'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#gstin'+id).html('<input type="text" value="'+$('#gstin'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $('#arn'+id).html('<input type="text" value="'+$('#arn'+id).html()+' " style="background-color:#eee;border-radius: 10px;">')
        $(this).val("Submit")
        // $('#d'+id).val("cancel")
        
        $(this).attr('id', $(this).attr('id').replace('e', 's'));
        $(this).attr('class', $(this).attr('class').replace('btn-edit', 'sub'));
        $('<td><input type="button"  id="c'+id+'" class="button btn btn-danger cancel" style="border-radius: 20px;"  value="Cancel"></td>').insertAfter($(this).parent());
        // $('#d'+id).addClass('cancel');
        // $('#d'+id).attr('class', $('#d'+id).attr('class').replace('btn-del', ' dd'));
        // $('#d'+id).attr('id', $('#d'+id).attr('id').replace('d', 'c'));
        // console.log($('#name'+id).children()[0].value)
        if ($('#heading th').length==10) {
        $("#heading").append('<th scope="col" style="font-weight:800;font-size: large;">Cancel</th>')
        }        
    });

    $("tbody").on("click",".sub",function(){

let id=$(this).attr("data-sid");
var name = $('#name'+id).children()[0].value
var account_no = $('#account_no'+id).children()[0].value
var ifsc = $('#ifsc'+id).children()[0].value
var bank_branch = $('#bank_branch'+id).children()[0].value
var swift_code = $('#swift_code'+id).children()[0].value
var cin = $('#cin'+id).children()[0].value
var pan = $('#pan'+id).children()[0].value
var gstin = $('#gstin'+id).children()[0].value
var arn = $('#arn'+id).children()[0].value

var csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
// mydata={cid:id,'csrfmiddlewaretoken':csrf_token}
mydata={'bank_id':id,'bank_name':name,'account_no':account_no,'ifsc_code':ifsc,'bank_branch':bank_branch,'swift_code':swift_code,'supplier_pan':pan,'supplier_gstin':gstin,'cin':cin,'arn':arn,'csrfmiddlewaretoken':csrf_token}
console.log(mydata)
        $.ajax({
            url:"bank_form",
            method:"POST",
            data:mydata,
            success:function(data){
                
                
                if(data.status==0){
                    console.log('your form not submitted')
                }
                else{
                    console.log('form submitted successfully')
                                                
                    location.reload();
                    
                }
                
            }
        })
    });

        
    $("tbody").on("click",".cancel",function(){
        // let id=$(this).attr("id");
        // id = id.split("")[1]
        // var address = $('#address'+id).children()[0].value
        // var gstin = $('#gst'+id).children()[0].value
        // var pan = $('#pan'+id).children()[0].value
        // var name = $('#name'+id).children()[0].value
        // var email = $('#email'+id).children()[0].value
        // var kind = $('#kind'+id).children()[0].value
        // var place = $('#place'+id).children()[0].value
        // $('#address'+id).html(address)
        // $('#gst'+id).html(gstin)
        // $('#pan'+id).html(pan)
        // $('#name'+id).html(name)
        // $('#email'+id).html(email)
        // $('#kind'+id).html(kind)
        // $('#place'+id).html(place)
        location.reload()
    });
</script>
 -->


<script>
  $('#addclient').click(function(){
      console.log("clicked")
  $('#addform').css('visibility','visible');
  $('#addform').css('z-index','1');
  $('#details').removeClass('bg-light')
  $('#details').removeClass('text-dark')
  $('#details').addClass('bg-dark')
  $('#details').addClass('text-light')
  $('#addclient').removeClass('bg-dark')
  $('#addclient').removeClass('text-light')
  $('#addclient').addClass('bg-light')
  $('#addclient').addClass('text-dark')
  $('#addclient').attr('disabled','true')
  $('#details').removeAttr('disabled')
  $('.table-detail').css('visibility','hidden');
  });
  $('#details').click(function(){
      console.log("clicked")
  $('#addform').css('visibility','hidden');
  $('#addform').css('z-index','-1');
  $('#addclient').removeClass('bg-light')
  $('#addclient').removeClass('text-dark')
  $('#addclient').addClass('bg-dark')
  $('#addclient').addClass('text-light')
  $('#details').removeClass('bg-dark')
  $('#details').removeClass('text-light')
  $('#details').addClass('bg-light')
  $('#details').addClass('text-dark')
  $('#details').attr('disabled','true')
  $('#addclient').removeAttr('disabled')
  // $('#details').addClass('bg-light')
  // $('#details').addClass('text-dark')
  $('.table-detail').css('visibility','visible');
  });
  $('#form_submit').on('submit', function() {
    // do validation here
    var regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/; 
    var inputvalues = $(pan).val();
    if (!regex.test($('#gst').val())) {
        alert("invalid GST no");
                    return false;    
                } 
        console.log("in form submit")
        regex = /[A-Z]{5}[0-9]{4}[A-Z]{1}$/; 
        if(!regex.test(inputvalues)){ 
        alert("invalid PAN no");
        return false;
        }
    return true;

});
  </script>
   
</body>
</html>